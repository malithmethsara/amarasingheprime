<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Use the Amarasinghe Prime Enterprises vehicle tax calculator for Sri Lanka to accurately estimate import taxes for petrol, diesel, and electric vehicles under 2025 Gazette Rates. Your trusted Japanese automobile partner." />
    <meta name="google-site-verification" content="8w8943-d9d83m2s" />
    <meta name="robots" content="index, follow" />
    <title>Vehicle Tax Calculator for Sri Lanka (2025) - Amarasinghe Prime Enterprises</title>
    
    <meta property="og:title" content="Sri Lanka Vehicle Tax Calculator (2025) by Amarasinghe Prime Enterprises" />
    <meta property="og:description" content="Accurately calculate your import taxes for Japanese vehicles in Sri Lanka with our up-to-date tax calculator for petrol, diesel, and electric cars." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.amarasingheprimeenterprises.com/vehicle-tax-calculator.html" />
    <meta property="og:image" content="https://www.amarasingheprimeenterprises.com/social-share-image.jpg" />

    <link rel="canonical" href="https://www.amarasingheprimeenterprises.com/vehicle-tax-calculator.html" />

    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <style>
        :root {
            --primary: #003087;
            --primary-hover: #002060;
            --primary-light: #e3edfb;
            --bg1: #f7f9fc;
            --bg2: #e9eff6;
            --text: #2b2b2b;
            --muted: #5b5b5b;
            --card: #fff;
            --soft-facebook: #e3edfb;
            --soft-whatsapp: #e6f7ec;
            --soft-black: #f4f4f4;
            --soft-facebook-border: #b6d2f7;
            --soft-whatsapp-border: #b9eac7;
            --soft-black-border: #d1d1d1;
        }
        body {
            font-family: 'Open Sans', sans-serif;
            background: linear-gradient(90deg, var(--bg1), var(--bg2));
            color: var(--text);
            width: 92%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 28px 24px 48px;
        }
        header {
            display: grid;
            grid-template-columns: 1fr;
            gap: 6px;
            align-items: center;
            justify-items: center;
            margin-bottom: 10px;
        }
        header h1 {
            font-weight: 700;
            font-size: 2.4rem;
            color: var(--primary);
            margin: 0;
            text-align: center;
        }
        header .tagline {
            color: var(--muted);
            font-weight: 600;
            text-align: center;
            margin-bottom: 6px;
        }
        #timeDateTime {
            text-align: center;
            color: var(--muted);
            margin-bottom: 8px;
        }
        .contact {
            display: flex;
            flex-wrap: wrap;
            gap: 14px;
            align-items: center;
            justify-content: center;
            margin: 10px 0 0 0;
            font-weight: 600;
        }
        .contact a {
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
        }
        .contact .chip {
            display: inline-flex;
            gap: 8px;
            align-items: center;
            padding: 8px 12px;
            border-radius: 999px;
            background: var(--card);
            box-shadow: 0 2px 8px rgba(0,0,0,.06);
            border: 1px solid rgb(220, 230, 246);
            transition: background .18s, border-color .18s, color .18s;
        }
        .contact .chip i { width: 18px; text-align: center; }
        .phone-chip {
            background: var(--soft-black) !important;
            color: #222 !important;
            border: 1px solid var(--soft-black-border) !important;
        }
        .phone-chip i, .phone-chip strong { color: #444 !important; }
        .whatsapp-chip {
            background: var(--soft-whatsapp) !important;
            color: #229e59 !important;
            border: 1px solid var(--soft-whatsapp-border) !important;
        }
        .whatsapp-chip i { color: #229e59 !important; }
        .facebook-chip {
            background: var(--soft-facebook) !important;
            color: #1877f3 !important;
            border: 1px solid var(--soft-facebook-border) !important;
        }
        .facebook-chip i { color: #1877f3 !important; }
        .container-main {
            display: flex;
            flex-wrap: wrap;
            gap: 0;
            margin-top: 10px;
            justify-content: space-between;
            align-items: stretch;
        }
        .form-section, .result-section {
            flex: 1 1 340px;
            min-width: 340px;
            max-width: 540px;
            background: var(--card);
            border: 1px solid rgba(0,48,135,.15);
            box-shadow: 0 4px 16px rgba(0,0,0,.06);
            border-radius: 16px;
            padding: 28px 26px 32px 26px;
            margin-bottom: 0;
            display: flex;
            flex-direction: column;
            min-height: 680px;
            position: relative;
            z-index: 1;
        }
        .form-section-title {
            text-align:center;
            font-weight:700;
            margin-bottom:12px;
            color:var(--primary);
            font-size:1.15rem;
        }
        label { display: block; margin-top: 14px; font-weight: 700; font-size: 0.98rem; }
        input, select {
            width: 100%;
            box-sizing: border-box;
            padding: 12px;
            margin-top: 6px;
            border: 1px solid var(--primary);
            border-radius: 10px;
            font-size: 1rem;
            background: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,.05);
            transition: border-color .15s;
            min-width: 0;
            display: block;
        }
        select {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background: #fff url("data:image/svg+xml;charset=UTF-8,<svg width='14' height='14' viewBox='0 0 20 20' fill='none' xmlns='http://www.w3.org/2000/svg'><path d='M6 8l4 4 4-4' stroke='%23003087' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/></svg>") no-repeat right 12px center/16px 16px;
        }
        .btn-row {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 18px;
        }
        .blue-btn {
            flex: 1 1 180px;
            padding: 12px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            color: #fff;
            background: var(--primary);
            box-shadow: 0 2px 8px rgba(0,0,0,.08);
            transition: background .18s;
            font-weight: 700;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .blue-btn:hover {
            background: var(--primary-hover);
        }
        #downloadBtn {
            display: none;
            flex: 1 1 180px;
            height: 44px;
            margin-top: 18px;
        }
        .result-section-title {
            font-weight:700;
            margin-bottom:10px;
            color:var(--primary);
            font-size:1.12rem;
        }
        #result { margin-top: 0; }
        table { width: 100%; border-collapse: collapse; }
        thead th { background: var(--primary); color: #fff; padding: 10px; text-align: left; }
        tbody td { padding: 9px 10px; border-bottom: 1px solid rgba(0,48,135,.15); }
        tfoot td { padding: 10px; font-weight: 700; background: #f0f4fa; }
        #pieChart {
            display: none;
            margin: 20px auto 0 auto;
            max-width: 100%;
            background: transparent;
        }
        footer {
            text-align: center;
            width: 100%;
            margin-top: 26px;
            color: #555;
            font-size: 0.92rem;
            padding: 14px 0 0 0;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        /* New section styling */
        .faq-section, .info-section, .disclaimer-section {
            background: var(--card);
            border: 1px solid rgba(0,48,135,.15);
            box-shadow: 0 4px 16px rgba(0,0,0,.06);
            border-radius: 16px;
            padding: 28px 26px 32px 26px;
            margin-top: 20px;
        }
        .faq-section h2, .info-section h2, .disclaimer-section h2 {
            text-align: center;
            font-weight: 700;
            font-size: 1.4rem;
            color: var(--primary);
            margin-bottom: 18px;
        }
        .faq-item {
            margin-bottom: 16px;
        }
        .faq-item h3 {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--text);
            margin: 0 0 8px 0;
        }
        .faq-item p {
            font-size: 0.95rem;
            color: var(--muted);
            line-height: 1.6;
        }
        .info-section p, .disclaimer-section p {
            font-size: 0.95rem;
            color: var(--muted);
            line-height: 1.6;
            margin-bottom: 1em;
        }
        .info-section h3 {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--text);
            margin: 24px 0 8px 0;
        }
        .info-section ul {
            padding-left: 20px;
            margin-bottom: 16px;
        }
        .info-section li {
            margin-bottom: 8px;
            font-size: 0.95rem;
        }
        .info-section a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
        }
        .info-section a:hover {
            text-decoration: underline;
        }
        .disclaimer-section ul {
            list-style: none;
            padding: 0;
            font-size: 0.95rem;
            color: var(--muted);
        }
        @media (max-width: 640px) {
            body {
                width: 100%;
                padding: 28px 2% 48px;
            }
            header h1 { font-size: 1.9rem; }
            .form-section, .result-section {
                padding: 20px 4%;
                min-height: auto;
                width: 92%;
                max-width: 100%;
                margin: 0 auto;
                position: static;
                box-sizing: border-box;
            }
            .container-main {
                flex-direction: column !important;
                gap: 16px !important;
                align-items: stretch !important;
            }
            .contact {
                flex-direction: column !important;
                gap: 8px !important;
                justify-content: center !important;
                align-items: center !important;
                margin-bottom: 8px !important;
                margin-top: 8px !important;
                width: 100%;
                max-width: 100%;
            }
            .contact a {
                flex: 1 1 90% !important;
                min-width: 90%;
                max-width: 90%;
                justify-content: center;
                align-items: center;
            }
            .contact .chip {
                width: 100%;
                justify-content: center;
                font-size: 0.92rem;
                padding: 10px 4px;
            }
            .result-section {
                margin-top: 0 !important;
            }
            #pieChart {
                max-width: 95vw;
            }
            .btn-row {
                flex-direction: row;
                gap: 8px;
                margin-top: 16px;
            }
            #downloadBtn {
                font-size: 0.93rem;
                margin-top: 16px;
            }
            .faq-section, .info-section, .disclaimer-section {
                padding: 20px 4%;
            }
            .faq-section h2, .info-section h2, .disclaimer-section h2 { font-size: 1.2rem; }
            .faq-item h3, .info-section h3 { font-size: 1rem; }
        }
    </style>
    
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "Product",
          "name": "Sri Lanka Vehicle Tax Calculator",
          "description": "An online tool to calculate import taxes for petrol, diesel, electric, and hybrid vehicles imported to Sri Lanka under the 2025 Gazette Rates. Accurate and up-to-date.",
          "brand": {
            "@type": "Brand",
            "name": "Amarasinghe Prime Enterprises"
          },
          "offers": {
            "@type": "Offer",
            "priceCurrency": "LKR",
            "price": "0",
            "availability": "https://schema.org/OnlineOnly",
            "url": "https://www.amarasingheprimeenterprises.com/vehicle-tax-calculator.html"
          },
          "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.9",
            "reviewCount": "25"
          }
        },
        {
          "@type": "LocalBusiness",
          "name": "Amarasinghe Prime Enterprises",
          "image": "https://www.amarasingheprimeenterprises.com/logo.jpg",
          "url": "https://www.amarasingheprimeenterprises.com/",
          "telephone": "+94769447740",
          "address": {
            "@type": "PostalAddress",
            "streetAddress": "3rd Lane, Malabe",
            "addressLocality": "Malabe",
            "addressRegion": "Western Province",
            "postalCode": "10115",
            "addressCountry": "LK"
          },
          "openingHoursSpecification": [
            {
              "@type": "OpeningHoursSpecification",
              "dayOfWeek": [
                "Monday",
                "Tuesday",
                "Wednesday",
                "Thursday",
                "Friday",
                "Saturday"
              ],
              "opens": "09:00",
              "closes": "17:00"
            }
          ]
        },
        {
          "@type": "FAQPage",
          "mainEntity": [
            {
              "@type": "Question",
              "name": "How is vehicle import tax calculated in Sri Lanka?",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "Vehicle import tax in Sri Lanka is a combination of several duties, including Customs Import Duty (CID), Surcharge, Excise Duty, Luxury Tax, and VAT. The exact amounts depend on the vehicle's CIF (Cost, Insurance, and Freight) value, the vehicle's engine or motor capacity (CC/kW), fuel type, and age. Our calculator uses the latest 2025 Sri Lankan Gazette rates to provide an accurate breakdown of all taxes."
              }
            },
            {
              "@type": "Question",
              "name": "What is the difference between a petrol hybrid and an e-SMART hybrid for tax purposes?",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "For tax calculation, the Sri Lankan Customs and Excise Department distinguishes between regular hybrids (like the Toyota Aqua or Honda Vezel) and e-SMART hybrids (like the Nissan Note e-Power). The rates applied to e-SMART vehicles are different and are based on a specific formula for electric motor capacity and generator type. Our tool accounts for these different tax structures to ensure accuracy."
              }
            },
            {
              "@type": "Question",
              "name": "Is the tax rate for electric vehicles the same as petrol vehicles in Sri Lanka?",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "No, electric vehicles (EVs) have a unique tax structure based on their motor capacity in kilowatts (kW) and vehicle age. The excise duty and other taxes are calculated differently compared to petrol or diesel vehicles, generally resulting in lower import taxes to encourage EV adoption. Our calculator provides separate tax calculations for electric, petrol, and diesel vehicles."
              }
            }
          ]
        }
      ]
    }
    </script>
</head>
<body>
    <header>
        <img src="logo.png" alt="Amarasinghe Prime Enterprises Logo" width="160" height="75" style="margin-bottom: 10px;">
        <h1>Amarasinghe Prime Enterprises</h1>
        <div class="tagline">Your trusted Japanese automobile partner</div>
        <div id="timeDateTime"></div>
    </header>
    <div class="contact" id="contact-row">
        <a class="chip phone-chip" href="tel:0769447740">
            <i class="fas fa-phone"></i> <strong>0769447740</strong>
        </a>
        <a class="chip whatsapp-chip" href="https://wa.me/message/XSPMWKK4BGVAM1" target="_blank" rel="noopener">
            <i class="fab fa-whatsapp"></i> WhatsApp
        </a>
        <a class="chip facebook-chip" href="https://www.facebook.com/share/17Ww1VkV2S/" target="_blank" rel="noopener">
            <i class="fab fa-facebook"></i> Facebook
        </a>
    </div>
    <div class="container-main">
        <div class="form-section">
            <div class="form-section-title">Vehicle Tax Calculator for Sri Lanka (2025 Gazette Rates)</div>
            <label for="cifJPY">CIF Value (JPY):</label>
            <input type="number" id="cifJPY" required min="0" step="any" />
            <label for="exchangeRate">Exchange Rate (JPY/LKR, e.g-2.1):</label>
            <input type="number" id="exchangeRate" required min="0" step="any" />
            <label for="vehicleType">Vehicle Type:</label>
            <select id="vehicleType" required>
                <option value="">Select Vehicle Type</option>
                <option value="petrol">Petrol</option>
                <option value="diesel">Diesel</option>
                <option value="petrol_hybrid">Petrol Hybrid</option>
                <option value="diesel_hybrid">Diesel Hybrid</option>
                <option value="petrol_plugin">Petrol Plug-in Hybrid</option>
                <option value="diesel_plugin">Diesel Plug-in Hybrid</option>
                <option value="electric">Electric</option>
                <option value="esmart_petrol">e-SMART Hybrid (Petrol Generator)</option>
                <option value="esmart_diesel">e-SMART Hybrid (Diesel Generator)</option>
            </select>
            <label for="capacity">Engine/ Motor Capacity (CC or kW):</label>
            <input type="number" id="capacity" required min="0" step="any" />
            <label for="age">Vehicle Age:</label>
            <select id="age" required>
                <option value="">Select Age</option>
                <option value="1">Not more than 1 year old</option>
                <option value="2">More than 1 year but not more than 3 years old</option>
            </select>
            <div class="btn-row">
                <button class="blue-btn" id="calculateBtn" onclick="calculateTax()">Calculate Tax</button>
                <button class="blue-btn" id="resetBtn" onclick="resetForm()">Reset</button>
            </div>
        </div>
        <div class="result-section">
            <div class="result-section-title">Calculation Result</div>
            <div id="result"></div>
            <div class="btn-row">
                <button id="downloadBtn" class="blue-btn" onclick="downloadPDF()">Save as PDF</button>
            </div>
            <canvas id="pieChart" width="360" height="180"></canvas>
        </div>
    </div>
    
    <div class="faq-section">
        <h2>Frequently Asked Questions about Sri Lankan Vehicle Import Tax</h2>
        <div class="faq-item">
            <h3>How do I calculate the import tax for a vehicle in Sri Lanka?</h3>
            <p>The total import tax is a combination of several duties, including Custom Import Duty (CID), Surcharge, Excise Duty, Luxury Tax, and VAT. The exact amounts depend on the vehicle's CIF value, engine/motor capacity, fuel type, and age. Our online calculator simplifies this complex process by applying the most recent 2025 Gazette rates to provide you with an accurate estimate instantly.</p>
        </div>
        <div class="faq-item">
            <h3>What is the CIF Value and why is it important for tax calculation?</h3>
            <p>CIF stands for Cost, Insurance, and Freight. It is the total value of the vehicle when it arrives in Sri Lanka, including its purchase price, shipping costs, and insurance. This value, converted from JPY to LKR, serves as the base for calculating several key taxes like the CID and VAT. The accuracy of your CIF value is crucial for a precise tax estimate.</p>
        </div>
        <div class="faq-item">
            <h3>Are hybrid vehicles taxed differently than petrol or diesel cars?</h3>
            <p>Yes, hybrid vehicles, including petrol hybrids, diesel hybrids, and plug-in hybrids, have different excise duty rates compared to conventional petrol or diesel cars. The tax structure is designed to promote more environmentally friendly vehicles. Our calculator is updated to reflect these special rates, ensuring you get a correct tax figure for your specific hybrid model.</p>
        </div>
    </div>

    <div class="info-section">
        <h2>Understanding Vehicle Taxes</h2>
        <p>
            Understanding the different types of taxes that make up the total vehicle import cost is key. Below is a breakdown of the main taxes applied in Sri Lanka:
        </p>
        <ul>
            <li>
                <h3>Customs Import Duty (CID)</h3>
                <p>
                    This is a base tax calculated as 20% of the vehicle's CIF (Cost, Insurance, and Freight) value.
                </p>
            </li>
            <li>
                <h3>Surcharge on CID</h3>
                <p>
                    An additional 50% tax applied on top of the Customs Import Duty (CID), effectively increasing the total CID to 30% of the CIF value.
                </p>
            </li>
            <li>
                <h3>Excise Duty</h3>
                <p>
                    This is a significant tax determined by the vehicle's engine capacity and fuel type, based on the latest <a href="https://cal.lk/wp-content/uploads/2023/12/Excise-Duty-rates.pdf" target="_blank" rel="noopener">Excise Duty Gazette</a>. The rates vary based on the vehicle's classification and engine size (in CC or kW).
                </p>
            </li>
            <li>
                <h3>Luxury Tax</h3>
                <p>
                    A tax applied when a vehicle's CIF value exceeds a specific threshold, which varies by fuel type. The tax rate also changes depending on the vehicle type.
                </p>
            </li>
            <li>
                <h3>Value Added Tax (VAT)</h3>
                <p>
                    An 18% Value Added Tax is charged on the total of the CIF value plus all other taxes (CID, Surcharge, Excise Duty, and Luxury Tax). See the official <a href="https://cal.lk/wp-content/uploads/2023/12/Customs-Duty-and-VAT-gazette.pdf" target="_blank" rel="noopener">Customs Duty and VAT Gazette</a> for more details.
                </p>
            </li>
        </ul>
    </div>
    
    <div class="disclaimer-section">
        <h2>Disclaimer & HS Codes</h2>
        <p>
            All vehicle taxes in Sri Lanka are determined by the Harmonized System (HS) codes. These international classifications categorize different vehicle types, such as petrol (8703.2x.xx), diesel (8703.3x.xx), and electric (8703.8x.xx) vehicles. Our calculations are based on the rates corresponding to these codes.
        </p>
        <p style="font-weight: 700;">
            Important Note: Our Vehicle Tax Calculator is designed to calculate duties only for standard motor cars within the HS codes listed above. It does not support calculations for special-purpose vehicles such as hearses, ambulances, or other commercial vehicles.
        </p>
    </div>

    <footer>© 2025 Amarasinghe Prime Enterprises™</footer>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script>
        let resultData = null;

        function updateDateTime() {
            const el = document.getElementById('timeDateTime');
            el.textContent = `Time: ${new Date().toLocaleString('en-GB', {timeZone: 'Asia/Colombo'})}`;
        }
        setInterval(updateDateTime, 1000);
        updateDateTime();

        async function fetchJPYtoLKR() {
            const rateElId = 'cbslRate';
            let rateEl = document.getElementById(rateElId);
            if (!rateEl) {
                rateEl = document.createElement('div');
                rateEl.id = rateElId;
                rateEl.style.textAlign = 'center';
                rateEl.style.marginTop = '8px';
                rateEl.style.color = 'var(--muted)';
                document.querySelector('.form-section').insertBefore(rateEl, document.getElementById('cifJPY').parentNode);
            }
            try {
                const resp = await fetch('https://api.exchangerate.host/latest?base=JPY&symbols=LKR');
                if (resp.ok) {
                    const data = await resp.json();
                    if (data && data.rates && data.rates.LKR) {
                        const rate = data.rates.LKR;
                        rateEl.innerHTML = `<div style="font-weight:700;color:var(--primary)">Exchange rate (live): 1 JPY = ${rate.toFixed(6)} LKR</div><div style="font-size:0.9em;color:var(--muted)">Source: exchangerate.host</div>`;
                        return;
                    }
                }
            } catch (e) {}
            rateEl.innerHTML = `<div style="font-weight:700;color:var(--primary)">Exchange rate: N/A</div><div style="font-size:0.9em;color:var(--muted)">Could not fetch live rate. Enter manually.</div>`;
        }
        fetchJPYtoLKR();

        function fmt(val, decimals=2) {
            return Number(val).toLocaleString('en-US', {minimumFractionDigits: decimals, maximumFractionDigits: decimals});
        }

        function calculateTax() {
            let cifJPY = parseFloat(document.getElementById('cifJPY').value);
            let exchangeRate = parseFloat(document.getElementById('exchangeRate').value);
            let type = document.getElementById('vehicleType').value;
            let capacity = parseFloat(document.getElementById('capacity').value);
            let age = document.getElementById('age').value;
            if (isNaN(cifJPY) || isNaN(exchangeRate) || isNaN(capacity) || !type || !age) {
                alert('Please fill in all fields with valid numbers.');
                return;
            }
            let cif = cifJPY * exchangeRate;

            let thresholds = {
                'petrol': 5000000, 'diesel': 5000000, 'petrol_hybrid': 5500000,
                'diesel_hybrid': 5500000, 'petrol_plugin': 5500000, 'diesel_plugin': 5500000,
                'electric': 6000000, 'esmart_petrol': 6000000, 'esmart_diesel': 6000000
            };
            let luxuryRates = {
                'petrol': 1.0, 'diesel': 1.2, 'petrol_hybrid': 0.8,
                'diesel_hybrid': 0.9, 'petrol_plugin': 0.8, 'diesel_plugin': 0.9,
                'electric': 0.6, 'esmart_petrol': 0.6, 'esmart_diesel': 0.6
            };
            let threshold = thresholds[type];
            let luxuryRate = luxuryRates[type];

            let cid = cif * 0.2;
            let surcharge = cid * 0.5;

            let excise = 0;
            if (type === 'petrol' || type === 'petrol_hybrid') {
                if (capacity < 300) excise = 482900;
                else if (capacity < 1000) excise = Math.max(1992000, capacity * 2450);
                else if (capacity <= 1300) excise = capacity * 3850;
                else if (capacity <= 1500) excise = capacity * 4450;
                else if (capacity <= 1600) excise = capacity * 5150;
                else if (capacity <= 1800) excise = capacity * 6400;
                else if (capacity <= 2000) excise = capacity * 7700;
                else if (capacity <= 2500) excise = capacity * 8450;
                else if (capacity <= 2750) excise = capacity * 9650;
                else if (capacity <= 3000) excise = capacity * 10850;
                else if (capacity <= 4000) excise = capacity * 12050;
                else excise = capacity * 13300;
            } else if (type === 'diesel' || type === 'diesel_hybrid') {
                if (capacity < 1500) excise = capacity * 5550;
                else if (capacity <= 1600) excise = capacity * 6950;
                else if (capacity <= 1800) excise = capacity * 8300;
                else if (capacity <= 2000) excise = capacity * 9650;
                else if (capacity <= 2500) excise = capacity * 9650;
                else if (capacity <= 2750) excise = capacity * 12050;
                else if (capacity <= 3000) excise = capacity * 13550;
                else if (capacity <= 4000) excise = capacity * 12050;
                else excise = capacity * 13300;
            } else if (type === 'electric' || type === 'petrol_plugin' || type === 'diesel_plugin') {
                let rate1, rate2;
                if (capacity <= 50) { rate1 = 18100; rate2 = 36200; }
                else if (capacity <= 100) { rate1 = 24100; rate2 = 36200; }
                else if (capacity <= 200) { rate1 = 36200; rate2 = 60400; }
                else { rate1 = 96600; rate2 = 132800; }
                excise = (age === '1') ? rate1 * capacity : rate2 * capacity;
            } else if (type === 'esmart_petrol') {
                let rate1, rate2;
                if (capacity <= 50) { rate1 = 43440; rate2 = 30770; }
                else if (capacity <= 100) { rate1 = 43440; rate2 = 40970; }
                else if (capacity <= 200) { rate1 = 63420; rate2 = 41630; }
                else { rate1 = 139440; rate2 = 111090; }
                excise = (age === '1') ? rate1 * capacity : rate2 * capacity;
            } else if (type === 'esmart_diesel') {
                let rate1, rate2;
                if (capacity <= 50) { rate1 = 52130; rate2 = 36920; }
                else if (capacity <= 100) { rate1 = 52130; rate2 = 49160; }
                else if (capacity <= 200) { rate1 = 76100; rate2 = 49960; }
                else { rate1 = 167330; rate2 = 133310; }
                excise = (age === '1') ? rate1 * capacity : rate2 * capacity;
            }
            let luxuryTax = (cif > threshold) ? (cif - threshold) * luxuryRate : 0;
            let vatBase = cif + cid + surcharge + excise + luxuryTax;
            let vat = vatBase * 0.18;
            let totalTax = cid + surcharge + excise + luxuryTax + vat;
            let total = cif + totalTax;

            resultData = {
                cifJPY, exchangeRate, cif, type, capacity, age,
                cid, surcharge, excise, luxuryTax, vat, totalTax, total
            };

            const unit = (type.includes('electric') || type.includes('plugin') || type.includes('esmart')) ? 'kW' : 'cc';
            const inputsTable = `
                <div style="font-weight:700;margin-bottom:6px;color:var(--primary)">Inputs</div>
                <table>
                    <thead><tr><th>Item</th><th style="text-align:right">Value</th></tr></thead>
                    <tbody>
                        <tr><td>CIF (JPY)</td><td style="text-align:right">${fmt(cifJPY)}</td></tr>
                        <tr><td>Exchange Rate (JPY→LKR)</td><td style="text-align:right">${fmt(exchangeRate,6)}</td></tr>
                        <tr><td>CIF (LKR)</td><td style="text-align:right">${fmt(cif)}</td></tr>
                        <tr><td>Vehicle Type</td><td style="text-align:right">${type.replace('_',' ').toUpperCase()}</td></tr>
                        <tr><td>Engine/ Motor Capacity</td><td style="text-align:right">${fmt(capacity)} ${unit}</td></tr>
                        <tr><td>Vehicle Age</td><td style="text-align:right">${age === '1' ? '≤1 year' : '>1–3 years'}</td></tr>
                    </tbody>
                </table>
            `;
            const pct = (val) => (total > 0 ? ((val/total)*100).toFixed(2) : '0.00');
            const breakdownTable = `
                <div style="font-weight:700;margin:18px 0 6px 0;color:var(--primary)">Cost Breakdown</div>
                <table>
                    <thead>
                        <tr>
                            <th>Item</th>
                            <th style="text-align:right">Value (LKR)</th>
                            <th style="text-align:right">% of Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${createRow('CIF', cif, pct(cif))}
                        ${createRow('CID', cid, pct(cid))}
                        ${createRow('Surcharge', surcharge, pct(surcharge))}
                        ${createRow('Excise Duty', excise, pct(excise))}
                        ${createRow('Luxury Tax', luxuryTax, pct(luxuryTax))}
                        ${createRow('VAT', vat, pct(vat))}
                    </tbody>
                    <tfoot>
                        <tr>
                            <td>Total Import Cost</td>
                            <td style="text-align:right">${fmt(total)}</td>
                            <td style="text-align:right">100.00%</td>
                        </tr>
                    </tfoot>
                </table>
            `;
            document.getElementById('result').innerHTML = inputsTable + breakdownTable;
            showPieChart([
                { label: 'CIF', value: cif },
                { label: 'Total Tax', value: totalTax }
            ], total);
            document.getElementById('result').style.display = 'block';
            document.getElementById('downloadBtn').style.display = 'block';

            // Auto-scroll to results on mobile devices
            if (window.innerWidth <= 640) {
                document.getElementById('result').scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        function pdfContactRow(doc, pageW, y) {
            const chipH = 28, chipPad = 16, chipGap = 18, chipFont = 12;
            const phoneW = 120, whatsappW = 105, facebookW = 105;
            const rowW = phoneW + whatsappW + facebookW + chipGap * 2;
            const leftX = pageW / 2 - rowW / 2;

            // Phone
            doc.setFillColor(244,244,244);
            doc.roundedRect(leftX, y, phoneW, chipH, 10, 10, 'F');
            doc.setDrawColor(209,209,209);
            doc.roundedRect(leftX, y, phoneW, chipH, 10, 10, 'S');
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(chipFont);
            doc.setTextColor(68,68,68);
            doc.text('0769447740', leftX + phoneW / 2, y + chipH/2 + chipFont/3.5, {align:"center"});
            doc.link(leftX, y, phoneW, chipH, {url: 'tel:0769447740'});

            // WhatsApp
            doc.setFillColor(230,247,236);
            doc.roundedRect(leftX+phoneW+chipGap, y, whatsappW, chipH, 10, 10, 'F');
            doc.setDrawColor(185,234,199);
            doc.roundedRect(leftX+phoneW+chipGap, y, whatsappW, chipH, 10, 10, 'S');
            doc.setTextColor(34,158,89);
            doc.setFont('helvetica', 'bold');
            doc.text('WhatsApp', leftX + phoneW + chipGap + whatsappW / 2, y + chipH/2 + chipFont/3.5, {align:"center"});
            doc.link(leftX+phoneW+chipGap, y, whatsappW, chipH, {url: 'https://wa.me/message/XSPMWKK4BGVAM1'});

            // Facebook
            doc.setFillColor(227,237,251);
            doc.roundedRect(leftX+phoneW+chipGap+whatsappW+chipGap, y, facebookW, chipH, 10, 10, 'F');
            doc.setDrawColor(182,210,247);
            doc.roundedRect(leftX+phoneW+chipGap+whatsappW+chipGap, y, facebookW, chipH, 10, 10, 'S');
            doc.setTextColor(24,119,243);
            doc.setFont('helvetica', 'bold');
            doc.text('Facebook', leftX+phoneW+chipGap+whatsappW+chipGap + facebookW/2, y + chipH/2 + chipFont/3.5, {align:"center"});
            doc.link(leftX+phoneW+chipGap+whatsappW+chipGap, y, facebookW, chipH, {url: 'https://www.facebook.com/share/17Ww1VkV2S/'});
        }

        function createRow(name, value, percentStr) {
            return `<tr><td>${name}</td><td style='text-align:right'>${fmt(value)}</td><td style='text-align:right'>${percentStr}%</td></tr>`;
        }
        function resetForm() {
            document.getElementById('cifJPY').value = '';
            document.getElementById('exchangeRate').value = '';
            document.getElementById('vehicleType').value = '';
            document.getElementById('capacity').value = '';
            document.getElementById('age').value = '';
            document.getElementById('result').innerHTML = '';
            document.getElementById('result').style.display = 'none';
            document.getElementById('downloadBtn').style.display = 'none';
            resultData = null;
            document.getElementById('pieChart').style.display = 'none';
            if (window.pieChartInstance) window.pieChartInstance.destroy();
        }
        function showPieChart(items, total) {
            const labels = items.map(i => {
                const pct = ((i.value / total) * 100).toFixed(2);
                return `${i.label} (${pct}%)`;
            });
            const values = items.map(i => i.value);
            const colors = [
                "#7ea1e7", "#cfe2fa", "#98e4bb", "#ffe395", "#b6b6b6", "#f9c4c4"
            ];
            const canvas = document.getElementById('pieChart');
            canvas.style.display = "block";
            if (window.pieChartInstance) window.pieChartInstance.destroy();
            window.pieChartInstance = new Chart(canvas, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        data: values,
                        backgroundColor: colors,
                        borderWidth: 2,
                        borderColor: "#fff"
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'bottom',
                            labels: { color: '#003087', font: { size: 13, weight: 600 } }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(ctx) {
                                    const pct = ((ctx.parsed / total) * 100).toFixed(2);
                                    return `${ctx.label}: ${fmt(ctx.parsed)} (${pct}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }
        function downloadPDF() {
            if (!resultData) { alert('Please calculate the tax first.'); return; }
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF({unit:'pt', format:'a4'});
            const pageW = doc.internal.pageSize.width;
            let y = 40;

            doc.setFont('helvetica', 'bold');
            doc.setFontSize(26);
            doc.setTextColor(0,48,135);
            doc.text('Amarasinghe Prime Enterprises', pageW/2, y, {align:"center"});
            y += 26;
            doc.setFontSize(13);
            doc.setTextColor(91,91,91);
            doc.text('Your trusted Japanese automobile partner', pageW/2, y, {align:"center"});
            y += 20;
            doc.setFontSize(11);
            doc.setTextColor(120,120,120);
            const combinedDateTime = `Generated: ${new Date().toLocaleString('en-GB', {timeZone:'Asia/Colombo'})}`;
            doc.text(combinedDateTime, pageW/2, y, {align:"center"});
            y += 20;
            pdfContactRow(doc, pageW, y);
            y += 50;
            doc.setFontSize(16);
            doc.setTextColor(0,48,135);
            doc.text('Vehicle Tax Calculator for Sri Lanka (2025 Gazette Rates)', pageW/2, y, {align:"center"});
            y += 18;

            const unit = (resultData.type.includes('electric') || resultData.type.includes('plugin') || resultData.type.includes('esmart')) ? 'kW' : 'cc';
            const inputRows = [
                ['CIF Value in foreign currency', fmt(resultData.cifJPY)],
                ['Exchange Rate', fmt(resultData.exchangeRate,6)],
                ['Fuel Type', resultData.type.replace('_',' ').toUpperCase()],
                ['Engine Capacity (CC) | Motor Power (Kw)', `${fmt(resultData.capacity)} ${unit}`]
            ];
            doc.autoTable({
                startY: y,
                head: [['Input Parameter','Value']],
                body: inputRows,
                theme: 'grid',
                headStyles: {
                    fillColor: [0,48,135],
                    textColor: [255,255,255],
                    fontStyle: 'bold',
                    fontSize: 12,
                    halign: 'left',
                    valign: 'middle',
                    lineWidth: 0.5,
                    lineColor: [0,48,135]
                },
                bodyStyles: {
                    fontStyle: 'normal',
                    fontSize: 11,
                    textColor: [40,40,40],
                    fillColor: [255,255,255],
                    halign: 'left',
                    valign: 'middle'
                },
                alternateRowStyles: { fillColor: [240,244,250] },
                tableLineColor: [220,220,220],
                tableLineWidth: 0.4,
                margin: { left: 60, right: 60 }
            });

            y = doc.lastAutoTable.finalY + 24;

            doc.setFontSize(13);
            doc.setTextColor(0,48,135);
            doc.text('Calculation Result', 60, y);
            y += 10;

            const taxBreakdown = [
                {id: '1.0', name: 'CID - Custom Import Duty', base: resultData.cif, rate: '20%', amount: resultData.cid},
                {id: '2.0', name: 'Surcharge', base: resultData.cid, rate: '50%', amount: resultData.surcharge},
                {id: '3.0', name: 'Excise Duty', base: resultData.capacity, rate: '', amount: resultData.excise},
                {id: '4.0', name: 'Luxury Tax', base: resultData.cif, rate: '', amount: resultData.luxuryTax},
                {id: '5.0', name: 'VAT', base: resultData.cif + resultData.cid + resultData.surcharge + resultData.excise + resultData.luxuryTax, rate: '18%', amount: resultData.vat}
            ];

            const breakdownRows = taxBreakdown.map(tax => [
                tax.name,
                fmt(tax.amount)
            ]);

            doc.autoTable({
                startY: y,
                head: [['Tax Type', 'Amount in LKR']],
                body: breakdownRows,
                theme: 'grid',
                headStyles: {
                    fillColor: [0,48,135],
                    textColor: [255,255,255],
                    fontStyle: 'bold',
                    fontSize: 12,
                    halign: 'left',
                    valign: 'middle',
                    lineWidth: 0.5,
                    lineColor: [0,48,135]
                },
                bodyStyles: {
                    fontStyle: 'normal',
                    fontSize: 11,
                    textColor: [40,40,40],
                    fillColor: [255,255,255],
                    halign: 'left',
                    valign: 'middle'
                },
                alternateRowStyles: { fillColor: [240,244,250] },
                tableLineColor: [220,220,220],
                tableLineWidth: 0.4,
                margin: { left: 60, right: 60 }
            });

            y = doc.lastAutoTable.finalY + 24;

            const summaryRows = [
                ['CIF', 'Total Tax', 'Total Value'],
                [fmt(resultData.cif), fmt(resultData.totalTax), fmt(resultData.total)]
            ];

            doc.autoTable({
                startY: y,
                head: summaryRows.slice(0,1),
                body: summaryRows.slice(1),
                theme: 'grid',
                headStyles: {
                    fillColor: [0,48,135],
                    textColor: [255,255,255],
                    fontStyle: 'bold',
                    fontSize: 12,
                    halign: 'left',
                    valign: 'middle',
                    lineWidth: 0.5,
                    lineColor: [0,48,135]
                },
                bodyStyles: {
                    fontStyle: 'normal',
                    fontSize: 11,
                    textColor: [40,40,40],
                    fillColor: [255,255,255],
                    halign: 'left',
                    valign: 'middle'
                },
                alternateRowStyles: { fillColor: [240,244,250] },
                tableLineColor: [220,220,220],
                tableLineWidth: 0.4,
                margin: { left: 60, right: 60 }
            });

            y = doc.lastAutoTable.finalY + 30;

            doc.setFontSize(8);
            doc.setTextColor(100,100,100);
            const disclaimerText = "Disclaimer: This is a guide based on current Sri Lankan tax laws for vehicles under HS codes under 8703.xx.xx. We are not responsible for future changes in tax laws, policies, or other related matters that may affect the accuracy or applicability of this information.";
            const disclaimerLines = doc.splitTextToSize(disclaimerText, pageW - 120);
            doc.text(disclaimerLines, pageW/2, y, {align:"center"});
            y += doc.getTextDimensions(disclaimerLines).h + 10;
            doc.text('© 2025 Amarasinghe Prime Enterprises™', pageW/2, doc.internal.pageSize.height - 20, {align:"center"});

            doc.save('Vehicle_Tax_Calculation.pdf');
        }
    </script>
</body>
</html>
